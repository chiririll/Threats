# 3 Разработка и верификация программного обеспечения системы выявления актуальных угроз информационной безопасности организации на основе сценарного подхода

## 3.1 Разработка программного обеспечения системы выявления актуальных угроз информационной безопасности организации на основе сценарного подхода

Процесс разработки программного обеспечения системы выявления актуальных угроз информационной безопасности организации на основе сценарного подхода представляет собой комплекс мероприятий, направленных на создание функционального и удобного инструмента для проведения опросов по методике ФСТЭК и формирования отчета об актуальных угрозах. Разработка велась с учетом требований к кроссплатформенности, надежности, удобству использования, а также с ориентацией на упрощение процесса внедрения в организации без необходимости установки дополнительного программного обеспечения.

В качестве основного языка программирования для реализации программного продукта был выбран C#. Этот язык обладает высокой популярностью и широкими возможностями для создания надежных и масштабируемых приложений, а также предоставляет богатый набор инструментов для работы с различными библиотеками и фреймворками [@csharp_reference]. В качестве основной платформы разработки использовалась среда .NET 9.0, которая обеспечивает высокую производительность, расширенные возможности взаимодействия с современными API, улучшенную работу с многопоточностью и асинхронными операциями [@dotnet]. При этом для обеспечения совместимости с существующими системами и минимизации зависимости от внешнего программного обеспечения обеспечена обратная совместимость с версией .NET Framework 4.7. Это решение позволяет запускать программное обеспечение на компьютерах с операционной системой Microsoft Windows без необходимости установки дополнительных версий фреймворка, что существенно улучшает пользовательский опыт.

Для разработки пользовательского интерфейса был выбран фреймворк Avalonia [@avalonia], схожий по подходам с Windows Presentation Foundation (WPF), но более гибкий в плане поддержки различных операционных систем. Avalonia предоставляет широкие возможности для создания современных и удобных интерфейсов с поддержкой различных платформ и устройств. Использование данной технологии позволило реализовать визуально привлекательный, удобный и интуитивно понятный интерфейс, который облегчает пользователям процесс прохождения опроса и выбора параметров в каждом из этапов анализа угроз.

В качестве среды разработки использовалась Visual Studio Code (VS Code) – легкая, гибкая и удобная интегрированная среда разработки, которая обеспечивает быстрый доступ к инструментам разработки и позволяет работать с проектом на различных операционных системах [@vscode]. Благодаря большому количеству доступных расширений для C#, Avalonia, а также работы с JSON, выбор именно этой среды разработки способствовал более удобной и продуктивной работе над проектом. Использование VS Code также позволило ускорить процесс интеграции сторонних библиотек и значительно упростить настройку среды для написания кроссплатформенного кода.

Для работы с данными в формате JSON в проекте использовалась библиотека Json.Net (также известная как Newtonsoft.Json), которая предоставляет удобные и гибкие средства сериализации и десериализации данных [@json_dotnet]. Данный выбор обусловлен популярностью и надежностью библиотеки, а также ее широкими возможностями по обработке сложных JSON-структур, что особенно важно при реализации сценарного подхода и необходимости хранения множества взаимосвязанных параметров опроса.

Функциональная реализация программного обеспечения включает несколько этапов, каждый из которых представляет собой логически завершенный блок работы с данными:

- определение вида негативных последствий – пользователь выбирает, какие виды последствий могут быть актуальными для информационной системы;
- определение самих негативных последствий – уточняется характер возможного ущерба или потерь;
- определение типа системы и возможных объектов воздействия – определяется классификация системы и ее компоненты, подверженные потенциальным угрозам безопасности;
- определение видов нарушителей – проводится анализ возможных типов нарушителей, их мотивации и ресурсов;
- выбор актуальных угроз – на основе предыдущих этапов формируется итоговый список угроз, требующих учета в системе защиты.

Для реализации функции экспорта данных в формат Excel была использована библиотека NPOI, которая обеспечивает удобную интеграцию с языком C# и платформой .NET. Эта библиотека позволяет создавать, редактировать и сохранять файлы формата .xlsx, что делает её подходящей для работы в среде .NET без необходимости использования сторонних компонентов или дополнительных программных продуктов [@npoi]. Применение NPOI позволило формировать итоговый отчёт программы в виде таблицы Excel, содержащей список актуальных угроз, их характеристики и выбранные параметры. Такой формат обеспечивает удобное представление информации, совместимость с распространенными офисными приложениями и возможность дальнейшего анализа результатов.

В ходе разработки основного программного продукта возникла необходимость в подготовке и преобразовании исходных данных, которые удобнее всего было формировать в виде таблиц Excel. Для автоматизации этого процесса было принято решение разработать дополнительную утилиту, которая конвертирует данные из формата Excel в формат JSON, необходимый для работы основной программы. Данное решение позволило сократить время на подготовку данных и снизить вероятность ошибок при их ручной обработке. Для реализации утилиты использовалась библиотека ExcelDataReader, обеспечивающая удобное чтение данных из файлов Excel, а также CommandLineParser для создания интерфейса командной строки и управления параметрами запуска программы [@excel_data_reader; @cli_parser]. Эта вспомогательная программа существенно упростила процесс подготовки исходных данных и повысила эффективность работы над проектом в целом.

Для организации архитектуры приложения был выбран паттерн MVVM (Model-View-ViewModel), который является стандартным подходом при разработке приложений с графическим интерфейсом на основе XAML-технологий [@mvvm], включая Avalonia. Применение данного паттерна позволило четко разделить логику представления данных (ViewModel) и визуальную часть приложения (View), обеспечив удобство в разработке, тестировании и поддержке программы. Модель (Model) отвечает за хранение и обработку данных, представление (View) – за отображение интерфейса пользователю, а ViewModel выступает связующим звеном между ними, обеспечивая логику взаимодействия и обработку событий. Такой подход повысил гибкость архитектуры приложения, упростил реализацию новых функций и обеспечил удобство внесения изменений в интерфейс без необходимости переписывать логику работы программы.

Архитектура модели программы построена на концепции шагов, которые последовательно формируют общее состояние приложения. Каждый шаг представляет собой отдельный компонент, отвечающий за выполнение конкретной задачи в рамках общего процесса анализа угроз. При этом сами этапы, описанные в методике, в коде программы явно не выделяются – вместо этого реализуется гибкая структура шагов, каждый из которых имеет доступ к общему состоянию приложения и может получать необходимые данные для формирования своего отображения. Такой подход позволяет сохранять целостность процесса, обеспечивая возможность перехода вперёд и назад между шагами, а также гибко реагировать на изменения пользовательского ввода. По завершении всех шагов на основе общего состояния формируется итоговый результат работы программы – список актуальных угроз информационной безопасности с учётом всех выбранных параметров. Листинг исходного кода разработанного приложения представлен в приложении А.

Таким образом, разработка программного обеспечения представляла собой комплексный процесс, включающий выбор технологий, проектирование архитектуры, реализацию пользовательского интерфейса, обработку данных и создание вспомогательных инструментов. Результатом этой работы стало создание программного продукта, который позволяет автоматизировать процесс выявления актуальных угроз информационной безопасности организации в соответствии с методикой ФСТЭК, снижая трудоемкость и повышая точность анализа.

## 3.2 Верификация разработанного программного обеспечения системы выявления актуальных угроз информационной безопасности организации на основе сценарного подхода

Для подтверждения работоспособности программного обеспечения и соответствия его заявленным требованиям проводится верификация созданного продукта. Этот этап включает детальную проверку всех функций приложения на корректность работы, стабильность выполнения задач, а также соответствие реализованного алгоритма логике методики ФСТЭК. Верификация представляет собой неотъемлемую часть жизненного цикла разработки, позволяющую выявить возможные ошибки на ранних этапах и удостовериться в том, что система соответствует ожиданиям как с технической, так и с методологической точек зрения.

Особое внимание в процессе верификации уделяется удобству пользовательского интерфейса, корректности обработки входных и выходных данных, а также точности формирования итогового списка актуальных угроз информационной безопасности. Кроме того, проверяется устойчивость системы к ошибочным действиям со стороны пользователя и способность корректно восстанавливаться после непредвиденных ситуаций, таких как прерывание сеанса работы.

Для демонстрации работы программы подготовлены скриншоты, иллюстрирующие основные этапы взаимодействия пользователя с программным обеспечением. На этих изображениях отображаются ключевые шаги процесса – начиная с запуска приложения и выбора параметров угроз, и заканчивая формированием итогового отчета в формате Excel. Такая визуализация помогает не только представить логику работы системы, но и служит наглядным подтверждением её готовности к использованию.
На рисунке [@fig:start] представлено стартовое окно программы, которое открывается при запуске приложения. Здесь пользователь может перейти к началу опроса, выбрав соответствующую опцию. Дизайн стартового окна выполнен в минималистичном стиле: интерфейс интуитивно понятен, все элементы расположены логично и не перегружены лишней информацией, что обеспечивает удобство восприятия и позволяет быстро приступить к работе.

![Стартовое окно программы](images/3/0.png){#fig:start}

На рисунке [@fig:negative_types] отображается интерфейс выбора актуальных видов ущерба. Пользователю предлагается отметить те виды ущерба, которые наиболее значимы для его организации, такие как утечка конфиденциальной информации, нарушение работоспособности информационных систем, ущерб деловой репутации и другие. Этот этап является первым шагом в процессе формирования сценария выявления угроз и закладывает основу для дальнейшего анализа. От правильности и полноты выбора на данном этапе зависит корректность последующих расчетов и рекомендаций. Интуитивно понятный интерфейс позволяет пользователю быстро ориентироваться в списке и принимать обоснованные решения, исходя из специфики деятельности своей организации. 

![Выбор актуальных видов ущерба](images/3/1.1.png){#fig:negative_types}

Рисунок [@fig:negatives] демонстрирует шаг, связанный с уточнением негативных последствий. На данном этапе пользователь детализирует характер возможных потерь и ущерба, исходя из ранее выбранных типов ущерба. Это позволяет более точно оценить потенциальные риски, с которыми может столкнуться организация. Пользователь может указать конкретные последствия, такие как финансовые убытки, простои в работе ключевых систем, утрата данных или снижение доверия со стороны партнёров. Такая детализация не только способствует формированию более точного и релевантного списка актуальных угроз, но и позволяет повысить точность моделирования сценариев развития инцидентов. 


![Выбор негативных последствий](images/3/1.2.png){#fig:negatives}

На рисунке [@fig:objects] представлена форма выбора типа объекта защиты, а также перечень объектов воздействия, характерных для информационной системы организации. Пользователь может указать, какие именно компоненты подлежат защите – будь то серверы, базы данных, сетевое оборудование, программные модули или иные критически важные элементы. Этот этап позволяет структурировать анализ, задать контекст для оценки угроз и связать возможные последствия с конкретными элементами инфраструктуры. Таким образом, формируется более точная модель риска, учитывающая архитектуру системы и особенности её функционирования. Корректный выбор объектов защиты играет ключевую роль в дальнейших этапах оценки и обеспечивает релевантность предложенных мер по снижению рисков. Интерфейс формы организован таким образом, чтобы пользователь мог быстро находить нужные категории, а также добавлять или исключать объекты в зависимости от специфики своей организации.

![Определение объектов воздействия](images/3/2.1-1.png){#fig:objects}

Также в программе реализована функция импорта объектов воздействия из внешнего файла, что значительно упрощает процесс начальной настройки и позволяет избежать ручного ввода большого объема информации. При нажатии на кнопку «Импорт» пользователь получает доступ к диалоговому окну выбора файла, как показано на рисунке [@fig:objects_import]. На текущий момент программа поддерживает импорт из простого текстового формата с заранее определённой структурой, что обеспечивает совместимость с большинством базовых источников данных. Однако архитектура программного обеспечения спроектирована таким образом, чтобы легко расширять список поддерживаемых форматов без необходимости в масштабных доработках. Благодаря этому в перспективе возможно добавить поддержку импорта из форматов CSV, JSON, XML, а также обеспечить интеграцию с внешними корпоративными системами. В качестве примера дальнейшей масштабируемости можно привести загрузку данных из популярных SIEM-систем, таких как Splunk, QRadar или ELK Stack, что откроет возможности для автоматического переноса информации об актуальных инцидентах и объектах воздействия напрямую в программу для дальнейшего анализа.

![Выбор файла для импорта объектов воздействия](images/3/2.1-2.png){#fig:objects_import}

Если при импорте файла произошла ошибка (например, формат файла не поддерживается, файл повреждён, отсутствуют необходимые данные или программа не смогла получить доступ к указанному пути), пользователю отображается информативное сообщение об ошибке, представленное на рисунке [@fig:objects_import_error]. Такая обратная связь позволяет быстро понять причину сбоя и предпринять необходимые действия для её устранения. Обработка подобных исключений реализована в рамках общей системы устойчивости интерфейса и предотвращает некорректную работу приложения при возникновении непредвиденных ситуаций. Это делает взаимодействие пользователя с программой более надёжным и повышает общее качество пользовательского опыта. 

![Ошибка импорта объектов воздействия](images/3/2.1-3.png){#fig:objects_import_error}

После того как эксперт завершил процедуру определения состава защищаемой системы путём ручного ввода или успешного импорта объектов воздействия, программа автоматически формирует и отображает полученный список этих объектов, как показано на рисунке [@fig:objects_additional]. Представление информации в виде структурированного списка позволяет пользователю быстро оценить полноту введённых данных и при необходимости внести корректировки. В случае, если эксперт обнаруживает отсутствие какого-либо объекта в перечне, он может оперативно добавить его вручную с помощью специальной формы, расположенной в нижней части окна. Эта форма поддерживает ввод всех необходимых параметров объекта, обеспечивая гибкость и точность в настройке. Таким образом, программа сочетает автоматизированный подход с возможностью ручной корректировки, что особенно важно при работе с уникальными или нестандартными конфигурациями информационных систем. Это повышает точность моделирования и делает процесс адаптации под конкретную инфраструктуру максимально удобным.

![Выбор дополнительных объектов воздействия](images/3/2.2-1.png){#fig:objects_additional}

На рисунке [@fig:objects_additional_dropdown] показан пример выпадающего списка объектов воздействия, используемого при ручном добавлении новых элементов в состав защищаемой системы. Такой подход обеспечивает удобство выбора из большого количества заранее определённых элементов и минимизирует вероятность ошибок при вводе данных, таких как опечатки или дублирование наименований. Кроме того, наличие предварительно сформированного справочника объектов способствует унификации вводимой информации, что особенно важно при последующем анализе и генерации отчётов. Использование таких элементов интерфейса делает работу эксперта более продуктивной и снижает когнитивную нагрузку при взаимодействии с системой.

![Выпадающий список объектов воздействия](images/3/2.2-2.png){#fig:objects_additional_dropdown}


После завершения этапа выбора объектов воздействия, пользователь переходит к следующему ключевому этапу – определению источников угроз. Этот процесс начинается с оценки актуальности потенциальных нарушителей, как показано на рисунке [@fig:intruder]. Для каждого возможного нарушителя эксперт должен ответить на два вопроса, отражённых в интерфейсе. Первый вопрос требует субъективной оценки специалиста относительно вероятности появления нарушителя в конкретной среде. Второй вопрос, о возможности реализации вредоносного воздействия, программа предварительно заполняет автоматически, опираясь на ранее выбранные негативные последствия и специфику защищаемых объектов.

Однако система оставляет за экспертом право вмешательства: если пользователь не согласен с автоматически предложенным вариантом, он может вручную изменить ответ. Это обеспечивает баланс между автоматизацией и профессиональной экспертизой, позволяя адаптировать модель угроз к конкретным условиям. 

Нарушитель признаётся актуальным только в случае утвердительного ответа на оба вопроса. Такой подход исключает формальное включение малозначимых источников угроз и позволяет сосредоточиться на действительно значимых и реалистичных сценариях.

![Определение актуальных нарушителей](images/3/3.1-1.png){#fig:intruder}

На рисунке [@fig:intruder_popup] показана всплывающая подсказка, содержащая описание потенциала нарушителя. Такие подсказки предусмотрены практически на каждом этапе работы программы и служат важным элементом интерфейсной поддержки пользователя. Они позволяют быстро освежить знания по ключевым терминам, не отвлекаясь на внешние источники информации или документацию. Благодаря этому снижается необходимость в предварительной подготовке или консультациях со справочными материалами, что особенно важно при ограниченном времени на проведение анализа. Такой механизм делает интерфейс более лаконичным, интуитивно понятным и удобным для восприятия, одновременно снижая когнитивную нагрузку во время работы с приложением.

![Всплывающая подсказка, описывающая потенциал нарушителя](images/3/3.1-2.png){#fig:intruder_popup}

Рисунок [@fig:intruders_class] иллюстрирует процесс определения категории каждого актуального нарушителя – внутренний или внешний. Эта классификация необходима для корректного построения модели угроз и последующего выбора защитных мер. Интерфейс позволяет последовательно пройтись по каждому нарушителю, для которого ранее был получен двойной утвердительный ответ, и указать его категорию. При этом пользователь может воспользоваться уже знакомой всплывающей подсказкой, которая уточняет критерии отнесения нарушителя к той или иной категории. Это дополнительно повышает точность принимаемых решений и делает процесс категоризации простым и прозрачным.

![Определение категории каждого актуального нарушителя](images/3/3.2.png){#fig:intruders_class}

На рисунке [@fig:threats] показан процесс оценки актуальности угроз безопасности информации. На этом этапе пользователю предоставляется перечень потенциальных угроз, каждая из которых может быть связана с ранее определёнными нарушителями, объектами воздействия и негативными последствиями. Пользователь принимает решение о том, являются ли конкретные угрозы актуальными для его информационной системы, исходя из возможных сценариев их реализации в контексте специфики инфраструктуры, уровня защищённости и характера обрабатываемой информации. Оценка проводится вручную, что позволяет учесть профессиональное суждение эксперта и особенности конкретной ситуации, которые не всегда могут быть автоматически учтены программой. При этом в интерфейсе предусмотрены пояснения и подсказки, помогающие пользователю быстро сориентироваться в описании каждой угрозы и принять обоснованное решение. Такая процедура обеспечивает точность и индивидуальность модели угроз, а также служит основой для последующего выбора адекватных мер защиты.

![Оценка актуальности УБИ](images/3/4-1.png){#fig:threats}

Рисунок [@fig:complete_confirmation] демонстрирует окно подтверждения, которое появляется перед формированием итогового списка актуальных угроз безопасности информации. Данный шаг служит важной контрольной точкой и позволяет предотвратить случайный или преждевременный переход к финальному этапу анализа. Пользователю предоставляется возможность еще раз просмотреть ключевые параметры, принятые в ходе работы – такие как список актуальных нарушителей, объекты воздействия и выбранные угрозы. Это особенно важно при работе с большим объемом данных или при поэтапном заполнении. Окно подтверждения снижает риск ошибок, связанных с невнимательностью или неполнотой ввода, и повышает достоверность конечного результата.

![Подтверждение перед формированием списка актуальных УБИ](images/3/4-2.png){#fig:complete_confirmation}

Рисунок [@fig:threats_result] показывает сформированный программой итоговый список актуальных угроз безопасности информации. Этот результат является итогом всей проведённой пользователем работы и представляет собой структурированный перечень тех угроз, которые были признаны релевантными для конкретной информационной системы на основании заданных параметров. Каждая угроза в списке может сопровождаться дополнительной информацией. Полученный список предназначен как для дальнейшего анализа, так и для использования в процессе принятия организационных и технических мер защиты. Программа предусматривает возможность экспорта этого списка в формат Excel, что обеспечивает удобство хранения, передачи и интеграции с другими информационными системами или внутренней документацией организации. Такой формат также облегчает работу с данными при подготовке отчётности, аудита или разработки политик информационной безопасности.

![Сформированный список актуальных УБИ](images/3/result.png){#fig:threats_result}

На рисунке [@fig:export_alert] представлено сообщение об успешном экспорте списка актуальных угроз безопасности информации. Это уведомление информирует пользователя о том, что результаты работы программы были успешно сохранены в файл формата Excel, что подтверждает корректное завершение операции экспорта. Для повышения удобства взаимодействия с приложением сообщение содержит кнопку «Посмотреть», которая позволяет мгновенно открыть экспортированный файл в программе Microsoft Excel. Такая функция существенно экономит время пользователя, устраняя необходимость вручную искать и запускать сохранённый документ. Кроме того, она способствует быстрому просмотру и проверке результатов без выхода из интерфейса программы, что особенно полезно при оперативной работе и подготовке отчетности.

![Сообщение об успешном экспорте списка актуальных УБИ](images/3/result-alert.png){#fig:export_alert}

Рисунок [@fig:threats_excel] демонстрирует экспортированный файл Excel, содержащий итоговый список актуальных угроз безопасности информации. Этот формат широко распространён и удобен для дальнейшей обработки, анализа и хранения данных. Экспортированный файл позволяет легко интегрировать результаты работы программы в существующую документацию по обеспечению информационной безопасности, а также использовать их при проведении аудитов, подготовке отчетов и планировании мероприятий по снижению рисков. Благодаря структурированному представлению данных в таблице, специалисты могут применять фильтры, сортировку и дополнительные вычисления, что значительно упрощает работу с информацией и повышает её практическую ценность для организации.

![Экспортированный список актуальных УБИ в виде файла Excel](images/3/result-export.png){#fig:threats_excel}

На рисунке [@fig:restart] показан интерфейс программы после успешного экспорта итогового списка актуальных угроз безопасности информации. После завершения процедуры сохранения данных на экране появляется специальная кнопка для перезапуска сценария, что предоставляет пользователю удобный и быстрый способ начать новый цикл анализа. Эта функциональная возможность особенно важна в условиях динамично меняющихся информационных систем и требований безопасности, когда необходимо регулярно проводить оценку угроз для разных систем или обновлённых конфигураций. Интерфейс при этом остаётся интуитивно понятным и удобным: кнопка размещена на видном месте, что исключает необходимость дополнительного поиска или переходов по меню. Таким образом, пользователь может плавно и без лишних усилий переключаться между этапами работы с программой, что значительно повышает общую продуктивность и комфорт использования. В целом, наличие данной функции делает приложение универсальным инструментом для регулярного и комплексного мониторинга актуальных угроз в разнообразных организационных условиях.

![Появление кнопки перезапуска после успешного экспорта](images/3/result-restart.png){#fig:restart}

Проведенная верификация подтверждает, что разработанное программное обеспечение соответствует поставленным требованиям и успешно выполняет задачи по выявлению актуальных угроз информационной безопасности организации на основе сценарного подхода. Все функции приложения работают стабильно, данные обрабатываются корректно, а результаты формируются в соответствии с методикой ФСТЭК. Взаимодействие с программой происходит интуитивно понятно, интерфейс удобен и не перегружен лишними элементами. Таким образом, разработанное программное обеспечение готово к использованию в практических задачах по обеспечению информационной безопасности.

## 3.3 Выводы по разделу 3

В ходе разработки программного обеспечения системы выявления актуальных угроз информационной безопасности организации на основе сценарного подхода была реализована полноценная программная архитектура, обеспечивающая выполнение всех ключевых задач по методике ФСТЭК. Процесс разработки включал выбор языков программирования, библиотек и фреймворков, проектирование архитектуры приложения, создание графического интерфейса, разработку логики работы программы, а также создание вспомогательных инструментов, необходимых для подготовки и обработки исходных данных.

Программа написана на языке C# с использованием платформы .NET 9.0 и обратной совместимостью с .NET Framework 4.7 для обеспечения широкого диапазона поддержки операционных систем Windows. Для реализации графического интерфейса использован кроссплатформенный фреймворк Avalonia, обеспечивающий удобство разработки и поддержку современного визуального оформления. Для работы с данными в формате JSON применена библиотека Json.NET, а для экспорта итоговых результатов в формат Excel – библиотека NPOI, которая легко интегрируется с C# и .NET.

Для обеспечения корректной работы программы была проведена верификация, в ходе которой протестированы все функции приложения, включая корректность обработки данных, стабильность выполнения операций, соответствие логики работы программы методике ФСТЭК, а также удобство использования интерфейса. Дополнительно верификация включала визуальную проверку интерфейса программы, что позволило убедиться в соответствии реализованного программного продукта всем заявленным требованиям.

В целом, разработанное программное обеспечение демонстрирует высокую степень готовности к практическому использованию и может быть рекомендовано в качестве инструмента для проведения анализа актуальных угроз информационной безопасности в организациях, а также для формирования соответствующей документации в рамках работы службы информационной безопасности.
